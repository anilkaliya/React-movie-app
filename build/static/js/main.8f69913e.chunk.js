(this["webpackJsonpblog-app-react"]=this["webpackJsonpblog-app-react"]||[]).push([[0],{26:function(e,t,a){"use strict";function n(){return localStorage.getItem("token")}function i(e){localStorage.setItem("expiresAt",e)}function r(e){localStorage.setItem("token",e)}function o(){var e=1e3*localStorage.getItem("expiresAt");setTimeout((function(){localStorage.setItem("token","")}),e)}function l(e){localStorage.setItem("user_id",e)}a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return l}))},46:function(e,t,a){e.exports=a(80)},51:function(e,t,a){},69:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},77:function(e,t,a){},78:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(17),o=a.n(r),l=(a(51),a(10)),c=a(14),s=a(27),u=a(11),d=a.n(u),m=(a(69),a(81)),p=a(82),g=a(83),h=a(12),E=[];var f=Object(h.b)((function(e){return{isAuthenticated:e.userData.isAuthenticated}}))((function(e){var t=this,a=(Object(c.f)(),Object(n.useState)(E)),r=Object(s.a)(a,2),o=r[0],u=r[1];return Object(n.useEffect)((function(){console.log("updated"),d.a.get("/api/posts").then((function(e){e.data.posts&&u(e.data.posts)}))}),[]),o.map((function(a){return i.a.createElement(m.a,null,i.a.createElement(p.a,null,i.a.createElement("div",{className:"one-movie"},i.a.createElement("div",{className:"title"},i.a.createElement("strong",null,a.title)),i.a.createElement("div",{className:"post-image"},i.a.createElement("img",{src:"data:image/png;base64,"+a.imagePath,alt:"movie.original_title"})),i.a.createElement("div",{className:"overview"},a.content),i.a.createElement(g.a,null,e.isAuthenticated&&a.creator===localStorage.getItem("user_id")&&i.a.createElement(l.b,{to:{pathname:"/edit",state:{id:a._id}}}," Edit")," "),i.a.createElement(g.a,null,e.isAuthenticated&&a.creator===localStorage.getItem("user_id")&&i.a.createElement("button",{style:{backgroundColor:"red"},onClick:function(){return e=a._id,void t.onDelete(e);var e}},"Delete")))))}))})),v=a(19),b=a(39),y=a(40),O=a(45),j=a(44),A=a(84),w=a(85),S=a(86),L=a(87),I=a(88),k=a(89),C=a(90),D=(a(75),function(e){Object(O.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(b.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t=new FormData;t.set("title",n.state.title),t.set("content",n.state.overview),t.append("image",n.state.file,n.state.title),n.setState({isLoading:!0}),n.id?(t.set("id",n.id),d.a.put("/api/posts/"+n.id,t).then((function(e){n.setState({isLoading:!1})})).catch((function(e){console.log(e)}))):d.a.post("/api/posts",t,{headers:{"Content-Type":n.state.type}}).then((function(e){n.setState({isLoading:!1})})).catch((function(e){console.log(e)})),n.props.history.push("/")},n.handleInput=function(e){var t=e.target.name;n.setState(Object(v.a)({},t,e.target.value))},n.onFileChange=function(e){var t=new FileReader,a=e.target.files[0];n.setState({type:a.type}),console.log(a.type),t.addEventListener("loadend",(function(){a=t.result})),t.readAsText(a),n.setState({file:a})},n.state={file:null,title:"",overview:"",isLoading:!1,type:""},n.id=null,n}return Object(y.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(this.props.location.state){var t=this.props.location.state.id;this.id=t,t&&d.a.get("/api/posts/"+t).then((function(t){console.log(t),e.setState({file:new Blob([t.data.imagePath]),title:t.data.title,overview:t.data.content})}))}}},{key:"render",value:function(){return i.a.createElement(m.a,{body:!0,outline:!0,color:"secondary"},i.a.createElement(A.a,{onSubmit:this.handleSubmit},i.a.createElement(w.a,{row:!0},i.a.createElement(S.a,{for:"title",sm:2},"Title"),i.a.createElement(L.a,{sm:7},i.a.createElement(I.a,{type:"textarea",name:"title",id:"title",value:this.state.title,onChange:this.handleInput}),i.a.createElement(k.a,null))),i.a.createElement(w.a,{row:!0},i.a.createElement(S.a,{for:"overview",sm:2},"OverView"),i.a.createElement(L.a,{sm:7},i.a.createElement(I.a,{type:"textarea",name:"overview",id:"title",value:this.state.overview,onChange:this.handleInput}),i.a.createElement(k.a,null))),i.a.createElement(w.a,null,i.a.createElement(L.a,{sm:7},i.a.createElement(I.a,{type:"file",name:"file",id:"image",onChange:this.onFileChange,accept:"image/jpeg,image/jpg,image/png"}),i.a.createElement(k.a,{color:"muted"}))),i.a.createElement(C.a,{color:"secondary",type:"submit"},"Submit Details")))}}]),a}(n.Component)),_=Object(c.g)(D),N=a(91);a(76);var x=Object(h.b)((function(e){return{isAuthenticated:e.userData.isAuthenticated}}))((function(e){return i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement(l.b,{to:"/"},"Movies")),i.a.createElement("li",null,i.a.createElement(l.b,{to:"/create"},e.isAuthenticated&&"Add Movie")),i.a.createElement("li",null,i.a.createElement(l.b,{style:{float:"right"},to:"/signup"},!e.isAuthenticated&&"Signup")),i.a.createElement("li",null,i.a.createElement(l.b,{to:"/login"}," ",!e.isAuthenticated&&"Login")))})),F=(a(77),Object(n.lazy)((function(){return a.e(3).then(a.bind(null,94))}))),R=Object(n.lazy)((function(){return a.e(4).then(a.bind(null,95))}));function T(){return i.a.createElement(l.a,null,i.a.createElement(x,null),i.a.createElement(c.c,null,i.a.createElement(c.a,{exact:!0,path:"/",component:f}),i.a.createElement(c.a,{path:"/create",component:_}),i.a.createElement(c.a,{path:"/edit",component:_}),i.a.createElement(n.Suspense,{className:"container",fallback:i.a.createElement(N.a,{className:"loader",style:{width:"8rem",height:"8rem"},type:"grow"})},i.a.createElement(c.a,{path:"/login",component:F}),i.a.createElement(c.a,{path:"/signup",component:R}))))}a(78);var B=function(e){return i.a.createElement(h.a,{store:e.store},i.a.createElement(T,null))},P=a(41),z={isLoading:!1,isError:"",registered:!1,isAuthenticated:!1};var M=a(15),G=a(42),J=a(43),U=Object(M.c)({userData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BEFORE_AUTH":return Object(P.a)({},e,{isLoading:t.payload.isLoading,isAuthenticated:t.payload.isAuthenticated,registered:t.payload.registered,isError:t.payload.isError});case"AFTER_SIGNUP":return Object.assign({},e,{isLoading:t.payload.isLoading,registered:t.payload.registered,isAuthenticated:t.payload.isAuthenticated,isError:t.payload.isError});case"AFTER_LOGIN":return Object.assign({},e,{registered:t.payload.registered,isLoading:t.payload.isLoading,isAuthenticated:t.payload.isAuthenticated,isError:t.payload.isError});case"ERROR":return Object.assign({},e,{isLoading:t.payload.isLoading,isError:t.payload.isError,isAuthenticated:t.payload.isAuthenticated,registered:t.payload.registered});default:return e}}}),q=Object(J.createLogger)(),H=Object(M.d)(U,Object(M.a)(G.a,q));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(79);var V=a(26);d.a.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+Object(V.b)(),e}),(function(e){Promise.reject(e)})),o.a.render(i.a.createElement(h.a,{store:H},i.a.createElement(B,{store:H})),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.8f69913e.chunk.js.map